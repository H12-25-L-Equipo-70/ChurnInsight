# ============================================================================
# CHURNINSIGHT APPLICATION PROPERTIES
# ============================================================================
# Predicción de Churn para Pymes Argentinas
# Oracle Autonomous Database + Spring Boot 3.x + Java 17
# ============================================================================

# Información de la Aplicación
spring.application.name=churninsight-backend
server.port=8080
server.servlet.context-path=/api/v1

# ============================================================================
# ORACLE DATABASE CONFIGURATION WITH WALLET
# ============================================================================

# Propiedades del Wallet Oracle
# Rutas CRÍTICAS: Deben apuntar al wallet descomprimido
oracle.wallet.wallet-path=../wallet_pymer
oracle.wallet.tns-admin-path=../wallet_pymer
oracle.wallet.database-name=pymerdb_high
oracle.wallet.username=admin
# NOTA: La contraseña debe estar en variables de entorno por seguridad
oracle.wallet.password=${ORACLE_DB_PASSWORD:}
oracle.wallet.trust-store-password=wallet_password
oracle.wallet.key-store-password=wallet_password

# Sistema propiedad para TNS_ADMIN (usado por Oracle JDBC Thin Driver)
oracle.net.tns_admin=../wallet_pymer

# ============================================================================
# JPA/HIBERNATE CONFIGURATION
# ============================================================================

# Dialecto de Hibernate para Oracle Database
spring.jpa.database-platform=org.hibernate.dialect.OracleDialect

# Mostrar SQL generado (deshabilitar en producción)
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true

# Estrategia de generación de DDL
spring.jpa.hibernate.ddl-auto=validate

# Propiedades adicionales de Hibernate
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.generate_statistics=false

# ============================================================================
# CONNECTION POOL CONFIGURATION
# ============================================================================

# UCP (Universal Connection Pool) - Oracle
spring.datasource.hikari.maximum-pool-size=30
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=900000
spring.datasource.hikari.max-lifetime=1800000

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

logging.level.root=INFO
logging.level.com.pymer.churninsight=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.data=DEBUG
logging.level.org.hibernate=WARN
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql=TRACE

# Log Pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ============================================================================
# ACTUATOR CONFIGURATION (Health Checks & Metrics)
# ============================================================================

management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.health.livenessState.enabled=true
management.health.readinessState.enabled=true

# ============================================================================
# FEIGN CLIENT CONFIGURATION (Comunicación con AI Service)
# ============================================================================

# FastAPI AI Service
feign.client.config.default.logger-level=full
feign.client.config.default.connect-timeout=5000
feign.client.config.default.read-timeout=30000

# ============================================================================
# APPLICATION-SPECIFIC PROPERTIES
# ============================================================================

# Churn Prediction Service
churn.prediction.timeout-seconds=30
churn.prediction.min-threshold=0.3

# ============================================================================
# PROFILES
# ============================================================================

# spring.profiles.active=dev

---

# ============================================================================
# PROFILE: DEVELOPMENT
# ============================================================================

spring.config.activate.on-profile=dev

logging.level.root=DEBUG
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=update

---

# ============================================================================
# PROFILE: PRODUCTION
# ============================================================================

spring.config.activate.on-profile=prod

logging.level.root=WARN
spring.jpa.show-sql=false
spring.jpa.hibernate.ddl-auto=validate

# Seguridad en producción
server.ssl.enabled=true
server.ssl.key-store=${KEYSTORE_PATH:/app/config/keystore.p12}
server.ssl.key-store-password=${KEYSTORE_PASSWORD}
server.ssl.key-store-type=PKCS12
