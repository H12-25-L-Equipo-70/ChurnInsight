# 1. Instalar librerías necesarias
!pip install oracledb pandas

# 2. Importar librerías
import oracledb
import pandas as pd

# 3. Subir el wallet.zip a Colab (usa el panel de archivos a la izquierda → Upload)
#    Supongamos que el archivo se llama "Wallet_fintech.zip"

# 4. Descomprimir el wallet
!unzip -o Wallet_PymerDB.zip -d wallet

# 5. Configurar credenciales
username = "FINTECH_PYMER"        # tu usuario en Oracle ADB
password = "FintechPymer123"  # la contraseña que definiste

# 6. Crear conexión usando el wallet
connection = oracledb.connect(
    user=FINTECH_PYMER,
    password=FintechPymer123,
    dsn="adb_high",          # alias definido en tnsnames.ora dentro del wallet
    config_dir="wallet",     # carpeta donde se descomprimió el wallet
    wallet_location="wallet",
    wallet_password=None     # si tu wallet tiene password, ponlo aquí
)

# 7. Ejecutar consulta y traer resultados a pandas
query = "SELECT CUIT, NOMBRE_EMPRESA, SECTOR, PROVINCIA FROM EMPRESAS"
df = pd.read_sql(query, con=connection)

# 8. Mostrar DataFrame
print(df.head())

# 9. Cerrar conexión
connection.close()
