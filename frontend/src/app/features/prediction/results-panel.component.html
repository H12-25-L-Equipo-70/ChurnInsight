<div *ngIf="predictionResult" class="space-y-6" role="region" aria-label="Resultados de la predicciÃ³n de churn">
  <!-- Header de Resultados -->
  <div [ngClass]="getRiskBgColor(predictionResult.prevision)" 
       class="border-l-4 rounded-lg p-6" role="status" aria-live="polite" aria-atomic="true">
    <div class="flex items-center justify-between mb-4">
      <div>
        <h3 class="text-sm text-slate-600 font-medium mb-1">Resultado de PredicciÃ³n</h3>
        <h2 class="text-3xl font-bold" [ngClass]="getRiskColor(predictionResult.prevision)">
          Riesgo {{ predictionResult.prevision | uppercase }}
        </h2>
      </div>
      <div class="text-right">
        <p class="text-sm text-slate-600 mb-1">Probabilidad de Churn</p>
        <p class="text-4xl font-bold text-slate-900" [attr.aria-label]="'Probabilidad de churn: ' + (predictionResult.probabilidad * 100).toFixed(1) + ' por ciento'">
          {{ (predictionResult.probabilidad * 100).toFixed(1) }}%
        </p>
      </div>
    </div>

    <!-- Barra de Progreso -->
    <div class="mt-4">
      <div class="flex-1 h-3 bg-slate-200 rounded-full overflow-hidden">
        <div 
          class="h-full bg-gradient-to-r from-emerald-500 to-red-500 transition-all duration-500"
          [style.width.%]="(predictionResult.probabilidad * 100)">
        </div>
      </div>
      <p class="text-xs text-slate-500 mt-2">
        0% (Bajo Riesgo) â†’ 100% (Alto Riesgo)
      </p>
    </div>
  </div>

  <!-- Confianza del Modelo -->
  <div *ngIf="predictionResult.confidence" class="bg-blue-50 border border-blue-200 rounded-lg p-4">
    <p class="text-sm text-slate-600 mb-2 font-medium">Confianza del Modelo ML</p>
    <div class="flex items-center gap-3">
      <div class="flex-1 h-2 bg-blue-200 rounded-full overflow-hidden">
        <div 
          class="h-full bg-blue-600 transition-all"
          [style.width.%]="(predictionResult.confidence * 100)">
        </div>
      </div>
      <p class="text-lg font-semibold text-blue-600 min-w-fit">
        {{ ((predictionResult.confidence || 0) * 100).toFixed(0) }}%
      </p>
    </div>
  </div>

  <!-- Recomendaciones -->
  <div *ngIf="predictionResult.recomendaciones && predictionResult.recomendaciones.length > 0" 
       class="bg-slate-50 border border-slate-200 rounded-lg p-6">
    <h4 class="text-lg font-semibold text-slate-900 mb-4">
      ðŸ“‹ Recomendaciones Prioritarias
    </h4>
    <ul class="space-y-3">
      <li *ngFor="let rec of predictionResult.recomendaciones; let i = index" 
          class="flex items-start gap-3 p-3 bg-white rounded-lg border border-slate-200 hover:shadow-md transition">
        <span class="inline-flex items-center justify-center h-6 w-6 rounded-full 
                     bg-slate-100 text-slate-700 font-semibold text-sm flex-shrink-0">
          {{ i + 1 }}
        </span>
        <span class="text-slate-700">{{ rec }}</span>
      </li>
    </ul>
  </div>

  <!-- Tarjeta de InformaciÃ³n de la Empresa -->
  <div *ngIf="profile" class="grid sm:grid-cols-2 gap-4">
    <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
      <p class="text-xs text-slate-500 uppercase tracking-wide font-semibold">Empresa</p>
      <p class="text-lg font-bold text-slate-900 mt-1">{{ profile.Nombre_Empresa || 'N/A' }}</p>
    </div>
    <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
      <p class="text-xs text-slate-500 uppercase tracking-wide font-semibold">CUIT</p>
      <p class="text-lg font-mono font-bold text-slate-900 mt-1">{{ profile.CUIT || 'N/A' }}</p>
    </div>
    <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
      <p class="text-xs text-slate-500 uppercase tracking-wide font-semibold">Sector</p>
      <p class="text-lg font-bold text-slate-900 mt-1">{{ profile.Sector || 'N/A' }}</p>
    </div>
    <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
      <p class="text-xs text-slate-500 uppercase tracking-wide font-semibold">Provincia</p>
      <p class="text-lg font-bold text-slate-900 mt-1">{{ profile.Provincia || 'N/A' }}</p>
    </div>
  </div>

  <!-- Estado de ExportaciÃ³n -->
  <div *ngIf="exportStatus.message" 
       [class.bg-emerald-50]="!exportStatus.isError"
       [class.bg-red-50]="exportStatus.isError"
       [class.text-emerald-700]="!exportStatus.isError"
       [class.text-red-700]="exportStatus.isError"
       class="rounded-lg p-3 text-sm font-medium border"
       [class.border-emerald-200]="!exportStatus.isError"
       [class.border-red-200]="exportStatus.isError">
    {{ exportStatus.message }}
  </div>

  <!-- Botones de AcciÃ³n -->
  <div class="flex flex-col sm:flex-row gap-3 pt-4 border-t border-slate-200">
    <!-- Descargar CSV -->
    <button
      (click)="downloadCSV()"
      type="button"
      class="flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg font-medium 
             hover:bg-emerald-700 transition flex items-center justify-center gap-2">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
      </svg>
      CSV
    </button>

    <!-- Descargar JSON -->
    <button
      (click)="downloadJSON()"
      type="button"
      class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium 
             hover:bg-blue-700 transition flex items-center justify-center gap-2">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
      </svg>
      JSON
    </button>

    <!-- Copiar -->
    <button
      (click)="copyToClipboard()"
      type="button"
      class="flex-1 px-4 py-2 bg-slate-600 text-white rounded-lg font-medium 
             hover:bg-slate-700 transition flex items-center justify-center gap-2">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
      </svg>
      Copiar
    </button>
  </div>

  <!-- BotÃ³n Nueva PredicciÃ³n -->
  <button
    (click)="startNewPrediction()"
    type="button"
    class="w-full px-6 py-3 bg-slate-900 text-white rounded-lg font-semibold 
           hover:bg-slate-800 transition">
    + Nueva PredicciÃ³n
  </button>
</div>
